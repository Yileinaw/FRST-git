# FRST-git 端到端 (E2E) 测试说明

本文档记录 FRST-git 项目端到端测试的相关信息。

## 1. 目标

模拟真实用户的使用场景，验证跨组件、跨页面的核心业务流程是否正常工作。

## 2. 工具

*   测试框架: `Cypress`
*   (可选) 可访问性检查: `cypress-axe` + `axe-core`
*   (可选) 可视化回归: `cypress-image-diff` 或类似插件/服务

## 3. 环境准备

*   **本地开发服务器:** E2E 测试需要在运行的应用实例上执行。通常在运行测试前启动本地开发服务器 (`npm run dev`)。
*   **Cypress 配置:**
    *   `cypress.config.ts`: 配置 `baseUrl` (指向本地开发服务器地址，如 `http://localhost:5173`)，视口大小，超时时间等。
    *   `cypress/support/e2e.ts`: 全局设置，导入自定义命令等。
    *   `cypress/support/commands.ts`: 定义可复用的自定义命令（如登录操作）。
    *   `cypress/fixtures/`: 存放测试数据（如模拟 API 响应、用户信息）。

## 4. 核心测试场景 (示例)

*   **用户认证流程:**
    *   访问登录页 -> 输入无效凭证 -> 验证错误提示。
    *   访问登录页 -> 输入有效凭证 -> 验证登录成功并跳转到首页/目标页 -> 验证导航栏显示用户信息。
    *   访问注册页 -> 输入有效信息 -> 验证注册成功并跳转。
    *   访问受保护页面（如个人中心）-> 未登录则应重定向到登录页。
*   **核心浏览与交互流程:**
    *   首页 -> 点击分类 -> 跳转到发现页 -> 验证分类已选中，列表显示正确。
    *   首页 -> 输入关键词搜索 -> 跳转到发现页 -> 验证搜索词已填充，列表显示正确。
    *   发现页 -> 点击美食卡片 -> 跳转到详情页 -> 验证详情信息正确。
    *   美食详情页 -> 点击"加入收藏" -> 验证按钮状态变化 -> 导航到个人中心 -> 验证该美食出现在收藏列表中。
    *   社区页 -> 点击"发布新帖" -> 填写内容并上传图片 -> 点击"发布" -> 验证帖子出现在列表顶部（可能需要 Mock API 或验证提示信息）。
    *   社区页 -> 点击帖子 -> 跳转到帖子详情页 -> 验证帖子内容和评论加载。
*   **个人中心操作:**
    *   访问个人中心 -> 修改用户名 -> 保存 -> 验证导航栏和页面信息更新。
    *   访问个人中心 -> 修改密码 -> 验证成功/失败提示。

## 5. 编写规范

*   测试文件位置: `cypress/e2e/` 目录下，按功能或流程组织文件 (如 `auth.cy.ts`, `discovery.cy.ts`)。
*   测试结构: 使用 `describe` 和 `it`。
*   选择器: 优先使用 `data-cy` 或 `data-testid` 等专用测试属性，其次是 ID、类名等（避免依赖易变的 CSS 类）。使用 `cy.get()`, `cy.contains()` 等命令。
*   断言: 使用 `should()`, `expect()` (需要 Chai-jQuery 风格) 或 `assert()`。
*   交互: 使用 `click()`, `type()`, `select()`, `check()`, `scrollIntoView()` 等模拟用户操作。
*   等待: 优先使用 Cypress 内建的自动等待和断言重试机制。谨慎使用 `cy.wait(固定时间)`。
*   自定义命令: 将重复操作（如登录）封装为自定义命令，提高可读性和可维护性。
*   测试数据: 使用 `cy.fixture()` 加载 Fixtures 中的数据。
*   API Mocking (可选但推荐): 使用 `cy.intercept()` 拦截和模拟 API 请求，使测试更稳定、快速，不依赖后端状态。

## 6. 运行测试

*   **图形界面 (开发调试):**
    ```bash
    npm run test:e2e:open
    ```
*   **命令行 (CI 或自动化):**
    ```bash
    npm run test:e2e
    ``` 